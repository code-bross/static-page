<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>실시간 테스트 - Vanilla JS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 사내 디자인 시스템 클래스 모사 */
        .bg-bg-02 { background-color: #f8f9fa; }
        .bg-spectrum-01 { background-color: #e3f2fd; }
        .bg-spectrum-02 { background-color: #f3e5f5; }
        .text-text-01 { color: #111111; }
        .text-text-03 { color: #888888; }
    </style>
</head>
<body class="min-h-screen bg-bg-02 pb-[80px]">

<div class="space-y-[24px]">
    <header class="p-[16px] bg-white border-b text-center font-bold text-[18px]">
        실시간 테스트
    </header>

    <section class="p-[24px] space-y-[32px] bg-spectrum-01 mx-[16px] rounded-lg">
        <h2 class="font-bold">카운터 테스트</h2>
        <div class="flex flex-col items-center gap-[20px]">
            <div id="counter-value" class="text-[40px] font-bold text-text-01">0</div>
            <div class="flex gap-[10px]">
                <button id="decrement"
                        class="w-[50px] h-[50px] bg-white border rounded-lg text-[24px] shadow-sm">-
                </button>
                <button id="increment"
                        class="w-[50px] h-[50px] bg-blue-500 text-white rounded-lg text-[24px] shadow-sm">
                    +
                </button>
            </div>
        </div>
    </section>

    <section class="p-[24px] space-y-[16px] bg-spectrum-02 mx-[16px] rounded-lg">
        <h2 class="font-bold">종목 리스트</h2>

        <div class="flex gap-[10px] mt-[8px]">
            <button class="flex-1 bg-blue-500 text-white p-[12px] rounded-lg font-bold"
                    onclick="requestAll()">전체 구독
            </button>
            <button class="flex-1 bg-white border p-[12px] rounded-lg font-bold"
                    onclick="console.log('전체 구독 취소')">전체 구독 취소
            </button>
        </div>

        <div id="stock-list-container" class="space-y-[12px]"></div>
    </section>
</div>

<script>
    /** 1. 데이터 모델 (StockItem) **/
    const StockItem = {
        createExamples: () => [
            {
                name: "삼성전자",
                symbol: "005930",
                price: "83600",
                sign: "1",
                diff: "1200",
                rate: "1.46",
                tradingVolume: "12,345,678주",
                tradingAmount: "1조2345억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/005930.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "SK하이닉스",
                symbol: "000660",
                price: "180000",
                sign: "2",
                diff: "3000",
                rate: "1.69",
                tradingVolume: "2,345,678주",
                tradingAmount: "4230억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/000660.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성바이오로직스",
                symbol: "207940",
                price: "780000",
                sign: "4",
                diff: "5000",
                rate: "-0.64",
                tradingVolume: "123,456주",
                tradingAmount: "960억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/207940.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "LG에너지솔루션",
                symbol: "373220",
                price: "410000",
                sign: "5",
                diff: "8000",
                rate: "-1.91",
                tradingVolume: "234,567주",
                tradingAmount: "950억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/373220.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성SDI",
                symbol: "006400",
                price: "550000",
                sign: "1",
                diff: "7000",
                rate: "1.29",
                tradingVolume: "345,678주",
                tradingAmount: "1900억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/006400.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대차",
                symbol: "005380",
                price: "260000",
                sign: "2",
                diff: "4000",
                rate: "1.56",
                tradingVolume: "456,789주",
                tradingAmount: "1200억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/005380.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "기아",
                symbol: "000270",
                price: "120000",
                sign: "1",
                diff: "2000",
                rate: "1.69",
                tradingVolume: "567,890주",
                tradingAmount: "680억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/000270.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "POSCO홀딩스",
                symbol: "005490",
                price: "600000",
                sign: "4",
                diff: "10000",
                rate: "-1.64",
                tradingVolume: "678,901주",
                tradingAmount: "4000억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/005490.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "LG화학",
                symbol: "051910",
                price: "350000",
                sign: "5",
                diff: "6000",
                rate: "-1.68",
                tradingVolume: "789,012주",
                tradingAmount: "2700억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/051910.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "NAVER",
                symbol: "035420",
                price: "210000",
                sign: "1",
                diff: "3000",
                rate: "1.45",
                tradingVolume: "890,123주",
                tradingAmount: "1870억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/035420.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "카카오",
                symbol: "035720",
                price: "48000",
                sign: "2",
                diff: "800",
                rate: "1.69",
                tradingVolume: "901,234주",
                tradingAmount: "430억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/035720.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성물산",
                symbol: "028260",
                price: "120000",
                sign: "1",
                diff: "1500",
                rate: "1.27",
                tradingVolume: "123,456주",
                tradingAmount: "150억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/028260.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대모비스",
                symbol: "012330",
                price: "230000",
                sign: "4",
                diff: "3000",
                rate: "-1.29",
                tradingVolume: "234,567주",
                tradingAmount: "540억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/012330.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "SK이노베이션",
                symbol: "096770",
                price: "170000",
                sign: "5",
                diff: "2500",
                rate: "-1.45",
                tradingVolume: "345,678주",
                tradingAmount: "590억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/096770.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "KB금융",
                symbol: "105560",
                price: "60000",
                sign: "1",
                diff: "900",
                rate: "1.52",
                tradingVolume: "456,789주",
                tradingAmount: "270억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/105560.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "신한지주",
                symbol: "055550",
                price: "42000",
                sign: "2",
                diff: "700",
                rate: "1.69",
                tradingVolume: "567,890주",
                tradingAmount: "238억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/055550.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "하나금융지주",
                symbol: "086790",
                price: "53000",
                sign: "1",
                diff: "800",
                rate: "1.53",
                tradingVolume: "678,901주",
                tradingAmount: "360억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/086790.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "카카오뱅크",
                symbol: "323410",
                price: "32000",
                sign: "4",
                diff: "600",
                rate: "-1.84",
                tradingVolume: "789,012주",
                tradingAmount: "252억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/323410.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "셀트리온",
                symbol: "068270",
                price: "180000",
                sign: "5",
                diff: "3500",
                rate: "-1.91",
                tradingVolume: "890,123주",
                tradingAmount: "1600억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/068270.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성생명",
                symbol: "032830",
                price: "80000",
                sign: "1",
                diff: "1200",
                rate: "1.52",
                tradingVolume: "901,234주",
                tradingAmount: "720억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/032830.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            // --- 이하 30개 추가 ---
            {
                name: "삼성화재",
                symbol: "000810",
                price: "220000",
                sign: "2",
                diff: "4000",
                rate: "1.85",
                tradingVolume: "123,456주",
                tradingAmount: "270억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/000810.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "LG전자",
                symbol: "066570",
                price: "110000",
                sign: "1",
                diff: "2000",
                rate: "1.85",
                tradingVolume: "234,567주",
                tradingAmount: "260억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/066570.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "KT&G",
                symbol: "033780",
                price: "90000",
                sign: "4",
                diff: "1500",
                rate: "-1.64",
                tradingVolume: "345,678주",
                tradingAmount: "310억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/033780.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "SK텔레콤",
                symbol: "017670",
                price: "57000",
                sign: "5",
                diff: "1000",
                rate: "-1.72",
                tradingVolume: "456,789주",
                tradingAmount: "260억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/017670.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "LG",
                symbol: "003550",
                price: "90000",
                sign: "1",
                diff: "1200",
                rate: "1.35",
                tradingVolume: "567,890주",
                tradingAmount: "180억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/003550.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "포스코퓨처엠",
                symbol: "003670",
                price: "400000",
                sign: "2",
                diff: "6000",
                rate: "1.52",
                tradingVolume: "678,901주",
                tradingAmount: "1200억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/003670.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "S-Oil",
                symbol: "010950",
                price: "90000",
                sign: "1",
                diff: "1500",
                rate: "1.69",
                tradingVolume: "789,012주",
                tradingAmount: "320억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/010950.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한국전력",
                symbol: "015760",
                price: "21000",
                sign: "4",
                diff: "300",
                rate: "-1.41",
                tradingVolume: "890,123주",
                tradingAmount: "190억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/015760.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "대한항공",
                symbol: "003490",
                price: "26000",
                sign: "5",
                diff: "400",
                rate: "-1.52",
                tradingVolume: "901,234주",
                tradingAmount: "230억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/003490.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "아모레퍼시픽",
                symbol: "090430",
                price: "120000",
                sign: "1",
                diff: "2000",
                rate: "1.69",
                tradingVolume: "123,456주",
                tradingAmount: "150억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/090430.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "CJ제일제당",
                symbol: "097950",
                price: "350000",
                sign: "2",
                diff: "5000",
                rate: "1.45",
                tradingVolume: "234,567주",
                tradingAmount: "320억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/097950.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한화솔루션",
                symbol: "009830",
                price: "40000",
                sign: "1",
                diff: "600",
                rate: "1.52",
                tradingVolume: "345,678주",
                tradingAmount: "140억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/009830.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대글로비스",
                symbol: "086280",
                price: "180000",
                sign: "4",
                diff: "3000",
                rate: "-1.64",
                tradingVolume: "456,789주",
                tradingAmount: "210억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/086280.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "롯데케미칼",
                symbol: "011170",
                price: "150000",
                sign: "5",
                diff: "2500",
                rate: "-1.64",
                tradingVolume: "567,890주",
                tradingAmount: "180억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/011170.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한온시스템",
                symbol: "018880",
                price: "11000",
                sign: "1",
                diff: "200",
                rate: "1.85",
                tradingVolume: "678,901주",
                tradingAmount: "75억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/018880.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대제철",
                symbol: "004020",
                price: "40000",
                sign: "2",
                diff: "600",
                rate: "1.52",
                tradingVolume: "789,012주",
                tradingAmount: "110억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/004020.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "두산에너빌리티",
                symbol: "034020",
                price: "18000",
                sign: "1",
                diff: "300",
                rate: "1.69",
                tradingVolume: "890,123주",
                tradingAmount: "60억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/034020.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "SK바이오사이언스",
                symbol: "302440",
                price: "70000",
                sign: "4",
                diff: "1200",
                rate: "-1.68",
                tradingVolume: "901,234주",
                tradingAmount: "90억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/302440.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한미사이언스",
                symbol: "008930",
                price: "40000",
                sign: "5",
                diff: "600",
                rate: "-1.48",
                tradingVolume: "123,456주",
                tradingAmount: "50억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/008930.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성전기",
                symbol: "009150",
                price: "150000",
                sign: "1",
                diff: "2500",
                rate: "1.69",
                tradingVolume: "234,567주",
                tradingAmount: "120억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/009150.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대건설",
                symbol: "000720",
                price: "40000",
                sign: "2",
                diff: "600",
                rate: "1.52",
                tradingVolume: "345,678주",
                tradingAmount: "80억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/000720.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "SKC",
                symbol: "011790",
                price: "90000",
                sign: "1",
                diff: "1500",
                rate: "1.69",
                tradingVolume: "456,789주",
                tradingAmount: "60억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/011790.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한미약품",
                symbol: "128940",
                price: "300000",
                sign: "4",
                diff: "5000",
                rate: "-1.64",
                tradingVolume: "567,890주",
                tradingAmount: "90억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/128940.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "CJ대한통운",
                symbol: "000120",
                price: "120000",
                sign: "5",
                diff: "2000",
                rate: "-1.64",
                tradingVolume: "678,901주",
                tradingAmount: "70억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/000120.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한국조선해양",
                symbol: "009540",
                price: "90000",
                sign: "1",
                diff: "1200",
                rate: "1.35",
                tradingVolume: "789,012주",
                tradingAmount: "60억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/009540.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "한화에어로스페이스",
                symbol: "012450",
                price: "120000",
                sign: "2",
                diff: "2000",
                rate: "1.69",
                tradingVolume: "890,123주",
                tradingAmount: "80억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/012450.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "현대미포조선",
                symbol: "010620",
                price: "90000",
                sign: "1",
                diff: "1500",
                rate: "1.69",
                tradingVolume: "901,234주",
                tradingAmount: "60억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/010620.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "삼성중공업",
                symbol: "010140",
                price: "7000",
                sign: "4",
                diff: "100",
                rate: "-1.41",
                tradingVolume: "123,456주",
                tradingAmount: "20억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/010140.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            },
            {
                name: "두산밥캣",
                symbol: "241560",
                price: "40000",
                sign: "5",
                diff: "600",
                rate: "-1.48",
                tradingVolume: "234,567주",
                tradingAmount: "30억원",
                imageUrl: "https://dev.kbox.kis-static.finance/images/icon/kr/241560.png",
                exchangeCodeForLanding: "KRX",
                nationForLanding: "KR"
            }
        ],
        createExamplesMap: function() {
            return this.createExamples().reduce((map, item) => {
                map[item.symbol] = item;
                return map;
            }, {});
        }
    };

    /** 2. 상태 관리 (Counter) **/
    let count = 0;
    const counterDisplay = document.getElementById('counter-value');
    const btnIncr = document.getElementById('increment');
    const btnDecr = document.getElementById('decrement');

    let stockMap = StockItem.createExamplesMap();

    function getBridge(name) {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      if (/android/i.test(ua)) {
        console.log("android");
        return window[name];
      } else if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) {
        console.log("iOS");
        return window.webkit?.messageHandlers;
      } else {
        console.log("unknown platform");
        return null;
      }
    }

    function executeBridge(functionName, data = null, bridgeName ='MtsBridge', ) {
      const bridge = getBridge(bridgeName);
      if (!bridge) {
        console.warn("No bridge available");
        return;
      }

      if (typeof bridge[functionName] === "function") {
        data != null ? bridge[functionName](data) : bridge[functionName]();
      } else if (typeof bridge[functionName] === "object") {
        bridge[functionName].postMessage(data != null ? data : "");
      } else {
        console.warn(`Bridge does not support: ${functionName}`);
      }
    }

    function updateCounter(value) {
        count += value;
        counterDisplay.innerText = count;
    }

    function requestAll(){
        const items = JSON.stringify(StockItem.createExamples());
        console.log(items);
        executeBridge('requestRealtimeQuotes', items);
    }

    function subscribe(_item){
        const item = JSON.stringify(_item);
        console.log(item);
        executeBridge('subscribeRealtimeQuote', item);
    }

    function unsubscribe(_item){
        const item = JSON.stringify(_item);
        executeBridge('unSubscribeRealtimeQuote', item);
    }

    function toNumber(str) {
        return Number(String(str).replace(/[^0-9.\-]/g, ''));
    }

    function receivedQuote(_item) {
        const item = JSON.parse(_item);
        console.log(item);
        console.log(_item);
        if (!item.symbol) return;
        stockMap[item.symbol] = item;
        updateItem(item);
    }

    function updateItem(item){

        const priceEl = document.getElementById(`price-${item.symbol}`);
        const diffEl = document.getElementById(`diff-${item.symbol}`);
        const rateEl = document.getElementById(`rate-${item.symbol}`);

         if (priceEl) {
            priceEl.className = `text-[16px] font-bold ${getPriceColor(item.sign)}`;
            priceEl.innerText = `${toNumber(item.price).toLocaleString()}원`;
        }
        if (diffEl) {
            diffEl.className = `flex gap-[4px] text-[12px] ${getPriceColor(item.sign)}`;
            diffEl.innerHTML = `
                <span>${getSignChar(item.sign)} ${toNumber(item.diff).toLocaleString()}</span>
                <span>(${item.rate ?? ''}%)</span>
            `;
        }
        if (rateEl) {
            rateEl.className = `text-[12px] ${getPriceColor(item.sign)}`;
            rateEl.innerText = `(${item.rate ?? ''}%)`;
        }
    }

    function cancelAll(){

    }

    btnIncr.addEventListener('click', () => updateCounter(1));
    btnDecr.addEventListener('click', () => updateCounter(-1));

    /** 3. 유틸리티 함수 (Price Color & Sign) **/
    const getPriceColor = (sign) => {
        if (['1', '2'].includes(sign)) return 'text-[#F44336]'; // 상승 (Red)
        if (['4', '5'].includes(sign)) return 'text-[#2979FF]'; // 하락 (Blue)
        return 'text-text-01';
    };

    const getSignChar = (sign) => {
        if (sign === '2') return '▲';
        if (sign === '5') return '▼';
        return '';
    };

    /** 4. 렌더링 함수 (Stock List) **/
    function renderStockList() {
        const container = document.getElementById('stock-list-container');
        const items = Object.values(stockMap);


        // 기존 아이템 모두 제거
        container.innerHTML = '';

        container.innerHTML = items.map(item => `
            <div class="flex items-center justify-between p-[16px] bg-white rounded-[16px] shadow-sm stock-item" data-symbol="${item.symbol}">
                <div class="flex items-center gap-[12px]">
                    <img src="${item.imageUrl}" alt="${item.name}" class="w-[40px] h-[40px] rounded-full" />
                    <div class="flex flex-col">
                        <span class="text-[16px] font-bold text-text-01">${item.name}</span>
                        <span class="text-[12px] text-text-03">${item.symbol}</span>
                    </div>
                </div>
                <divse class="flex flex-col items-end">
                    <span class="text-[16px] font-bold ${getPriceColor(item.sign)}">
                        ${toNumber(item.price).toLocaleString()}원
                    </span>
                    <div class="flex gap-[4px] text-[12px] ${getPriceColor(item.sign)}">
                        <span>${getSignChar(item.sign)} ${toNumber(item.diff).toLocaleString()}</span>
                        <span>(${item.rate}%)</span>
                    </div>
                </div>
            </div>
        `).join('');

        container.querySelectorAll('.stock-item').forEach(el => {

            el.addEventListener('click', function() {
                const symbol = this.getAttribute('data-symbol');
                const item = stockMap[symbol];
                if (item) subscribe(item);
            });
        });
    }

    function subscribeAll(){
        const items = Object.values(stockMap);
        items.forEach(item => {
                    subscribe(item);
            });
    }


    // 초기화
    renderStockList();
    subscribeAll();
</script>
</body>
</html>
