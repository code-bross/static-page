<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>저희의 소중한 기록 - Wedding Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700&family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Pretendard', sans-serif; overflow: hidden; background-color: #faf9f6; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* [톤앤톤 핵심 컬러 설정] */
        :root {
            --point-color: #8d7b68; /* 따뜻한 브라운 톤 */
            --bg-color: #faf9f6;    /* 부드러운 크림색 */
        }

        /* 선택된 탭 스타일 */
        .tab-active {
            color: var(--point-color) !important;
            border-bottom: 3px solid var(--point-color) !important;
            font-weight: 700;
        }

        /* 선택된 칩 스타일 */
        .chip-active {
            background-color: var(--point-color) !important;
            color: white !important;
            border-color: var(--point-color) !important;
            box-shadow: 0 4px 12px rgba(141, 123, 104, 0.2);
        }

        iframe { width: 100%; border: none; transition: all 0.3s ease-in-out; }

        /* 헤더 타이틀 폰트 */
        .serif-title { font-family: 'Noto Serif KR', serif; }
    </style>
</head>
<body class="text-[#4a4a4a]">

<header class="bg-white border-b border-[#eeeae5] sticky top-0 z-50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row md:items-center justify-between">
        <div class="py-4 md:py-0">
            <h1 class="serif-title text-xl font-bold text-[#8d7b68]">Wedding Story</h1>
        </div>
        <nav id="main-tabs" class="flex space-x-6 overflow-x-auto no-scrollbar">
        </nav>
    </div>
</header>

<div id="chips-wrapper" class="bg-[#f4f1ee] border-b border-[#eeeae5] transition-all duration-300 hidden">
    <div class="max-w-7xl mx-auto px-4 py-3 flex space-x-2 overflow-x-auto no-scrollbar" id="sub-chips">
    </div>
</div>

<main class="relative bg-white">
    <div id="loading-spinner" class="absolute inset-0 flex items-center justify-center bg-[#faf9f6]/80 z-10 hidden backdrop-blur-sm">
        <div class="flex flex-col items-center">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-[#8d7b68] mb-3"></div>
            <p class="text-xs text-[#8d7b68] font-medium serif-title">이야기를 불러오고 있습니다</p>
        </div>
    </div>
    <iframe id="content-view" src="" title="Wedding Content"></iframe>
</main>

<script>
    const weddingData = {
        "tabs" : [
            {
                "name" : "첫인사",
                "url" : "https://code-bross.github.io/static-page//wedding/pre-intro.html"
            },
            {
                "name" : "결혼식장",
                "url" : "https://code-bross.github.io/static-page//wedding/radomus-amorium-hall.html"
            },
            {
                "name" : "예산 현황",
                "chips" : [
                    { "name" : "8월 예산안", "url" : "https://code-bross.github.io/static-page//wedding/26-08-estimated.html" },
                    { "name" : "10월 예산안", "url" : "https://code-bross.github.io/static-page//wedding/26-10-estimated.html" }
                ]
            },
            {
                "name" : "앞으로 계획",
                "url" : "https://code-bross.github.io/static-page//wedding/pre-plan.html"
            },
        ]
    };

    const tabContainer = document.getElementById('main-tabs');
    const chipWrapper = document.getElementById('chips-wrapper');
    const chipContainer = document.getElementById('sub-chips');
    const iframe = document.getElementById('content-view');
    const spinner = document.getElementById('loading-spinner');

    function init() {
        renderTabs();
        selectTab(0);
    }

    function renderTabs() {
        weddingData.tabs.forEach((tab, i) => {
            const btn = document.createElement('button');
            // 텍스트를 조금 더 정중하게 변경 가능
            btn.className = "py-5 px-1 text-sm font-semibold whitespace-nowrap border-b-2 border-transparent text-[#999] hover:text-[#8d7b68] transition-all";
            btn.innerText = tab.name;
            btn.onclick = () => selectTab(i);
            tabContainer.appendChild(btn);
        });
    }

    function selectTab(idx) {
        const tabs = tabContainer.querySelectorAll('button');
        const target = weddingData.tabs[idx];

        tabs.forEach((t, i) => {
            if(i === idx) t.classList.add('tab-active');
            else t.classList.remove('tab-active');
        });

        if (target.chips && target.chips.length > 0) {
            chipWrapper.classList.remove('hidden');
            renderChips(target.chips);
            selectChip(0, target.chips);
            updateHeight(true);
        } else {
            chipWrapper.classList.add('hidden');
            loadUrl(target.url);
            updateHeight(false);
        }
    }

    function renderChips(chips) {
        chipContainer.innerHTML = '';
        chips.forEach((chip, i) => {
            const btn = document.createElement('button');
            btn.className = "px-5 py-2 text-xs font-bold rounded-full border border-[#d1ccc4] text-[#8d7b68] bg-white hover:bg-[#fdfbf7] transition-all whitespace-nowrap shadow-sm";
            btn.innerText = chip.name;
            btn.onclick = () => selectChip(i, chips);
            chipContainer.appendChild(btn);
        });
    }

    function selectChip(idx, chips) {
        const chipBtns = chipContainer.querySelectorAll('button');
        chipBtns.forEach((c, i) => {
            if(i === idx) c.classList.add('chip-active');
            else c.classList.remove('chip-active');
        });
        loadUrl(chips[idx].url);
    }

    function loadUrl(url) {
        spinner.classList.remove('hidden');
        iframe.src = url;
        iframe.onload = () => {
            setTimeout(() => spinner.classList.add('hidden'), 300); // 부드러운 로딩 처리
        };
    }

    function updateHeight(hasChips) {
        const headerHeight = document.querySelector('header').offsetHeight;
        const chipHeight = hasChips ? 57 : 0;
        iframe.style.height = `calc(100vh - ${headerHeight + chipHeight}px)`;
    }

    window.addEventListener('resize', () => {
        const hasChips = !chipWrapper.classList.contains('hidden');
        updateHeight(hasChips);
    });

    init();
</script>
</body>
</html>
