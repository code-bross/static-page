<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Hub - Integrated Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Pretendard', sans-serif; overflow: hidden; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* 선택된 탭 스타일 */
        .tab-active {
            color: #4f46e5 !important;
            border-bottom: 3px solid #4f46e5 !important;
            font-weight: 700;
        }

        /* 선택된 칩 스타일 */
        .chip-active {
            background-color: #4f46e5 !important;
            color: white !important;
            border-color: #4f46e5 !important;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        iframe { width: 100%; border: none; transition: all 0.3s; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

<header class="bg-white border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4">
        <nav id="main-tabs" class="flex space-x-8 overflow-x-auto no-scrollbar">
        </nav>
    </div>
</header>

<div id="chips-wrapper" class="bg-white border-b border-slate-100 shadow-sm transition-all duration-300 hidden">
    <div class="max-w-7xl mx-auto px-4 py-3 flex space-x-2 overflow-x-auto no-scrollbar" id="sub-chips">
    </div>
</div>

<main class="relative bg-white">
    <div id="loading-spinner" class="absolute inset-0 flex items-center justify-center bg-white z-10 hidden">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
    </div>
    <iframe id="content-view" src="" title="Wedding Content"></iframe>
</main>

<script>
    const weddingData = {
        "tabs" : [
            {
                "name" : "첫인사",
                "url" : "https://code-bross.github.io/static-page//wedding/pre-intro.html"
            },
            {
                "name" : "결혼식장",
                "url" : "https://code-bross.github.io/static-page//wedding/radomus-amorium-hall.html"
            },
            {
                "name" : "예산",
                "chips" : [
                    { "name" : "8월 예산", "url" : "https://code-bross.github.io/static-page//wedding/26-08-estimated.html" },
                    { "name" : "10월 예산", "url" : "https://code-bross.github.io/static-page//wedding/26-10-estimated.html" }
                ]
            }
        ]
    };

    const tabContainer = document.getElementById('main-tabs');
    const chipWrapper = document.getElementById('chips-wrapper');
    const chipContainer = document.getElementById('sub-chips');
    const iframe = document.getElementById('content-view');
    const spinner = document.getElementById('loading-spinner');

    function init() {
        renderTabs();
        selectTab(0); // 초기 진입 시 첫 번째 탭 선택
    }

    function renderTabs() {
        weddingData.tabs.forEach((tab, i) => {
            const btn = document.createElement('button');
            btn.className = "py-4 px-2 text-sm font-medium whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700 transition-all";
            btn.innerText = tab.name;
            btn.onclick = () => selectTab(i);
            tabContainer.appendChild(btn);
        });
    }

    function selectTab(idx) {
        const tabs = tabContainer.querySelectorAll('button');
        const target = weddingData.tabs[idx];

        // 탭 활성화 표시
        tabs.forEach((t, i) => {
            if(i === idx) t.classList.add('tab-active');
            else t.classList.remove('tab-active');
        });

        if (target.chips && target.chips.length > 0) {
            chipWrapper.classList.remove('hidden');
            renderChips(target.chips);
            selectChip(0, target.chips); // 칩이 있으면 첫 번째 칩 자동 선택
            updateHeight(true);
        } else {
            chipWrapper.classList.add('hidden');
            loadUrl(target.url);
            updateHeight(false);
        }
    }

    function renderChips(chips) {
        chipContainer.innerHTML = '';
        chips.forEach((chip, i) => {
            const btn = document.createElement('button');
            btn.className = "px-4 py-1.5 text-xs font-semibold rounded-full border border-slate-200 text-slate-600 bg-white hover:bg-slate-50 transition-all whitespace-nowrap";
            btn.innerText = chip.name;
            btn.onclick = () => selectChip(i, chips);
            chipContainer.appendChild(btn);
        });
    }

    function selectChip(idx, chips) {
        const chipBtns = chipContainer.querySelectorAll('button');

        // 칩 활성화 표시
        chipBtns.forEach((c, i) => {
            if(i === idx) c.classList.add('chip-active');
            else c.classList.remove('chip-active');
        });

        loadUrl(chips[idx].url);
    }

    function loadUrl(url) {
        spinner.classList.remove('hidden');
        iframe.src = url;
        iframe.onload = () => spinner.classList.add('hidden');
    }

    function updateHeight(hasChips) {
        const offset = hasChips ? 116 : 60; // 탭높이 + 칩높이 고려
        iframe.style.height = `calc(100vh - ${offset}px)`;
    }

    init();
</script>
</body>
</html>
